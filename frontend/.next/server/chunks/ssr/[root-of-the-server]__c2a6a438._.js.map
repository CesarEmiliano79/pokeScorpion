{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///D:/Seguridad%20Informatica/ScorpionWeb/frontend2/src/components/ProtectedPage.jsx"],"sourcesContent":["'use client';\r\nimport { useEffect } from 'react';\r\nimport { useRouter, usePathname } from 'next/navigation';\r\n\r\nexport default function ProtectedPage({ children }) {\r\n  const router = useRouter();\r\n  const pathname = usePathname();\r\n\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      try {\r\n        const res = await fetch('http://localhost:3001/api/autenticacion/check', {\r\n          method: 'GET',\r\n          credentials: 'include',\r\n        });\r\n        const data = await res.json();\r\n\r\n        if (res.ok) {\r\n          console.log('Usuario autenticado, admin?', data.esAdmin);\r\n\r\n          // Redirige solo si est치s en login o registro\r\n          const loginPages = ['/pages/login', '/pages/registro'];\r\n          if (loginPages.includes(pathname)) {\r\n            router.replace('/pages/home');\r\n          }\r\n        }\r\n        // Si no est치 autenticado, no hacemos nada -> puede navegar a login/registro\r\n      } catch (error) {\r\n        console.error('Error al verificar sesi칩n:', error);\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [router, pathname]);\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAIe,SAAS,cAAc,EAAE,QAAQ,EAAE;IAChD,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,WAAW,IAAA,iJAAW;IAE5B,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY;YAChB,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM,iDAAiD;oBACvE,QAAQ;oBACR,aAAa;gBACf;gBACA,MAAM,OAAO,MAAM,IAAI,IAAI;gBAE3B,IAAI,IAAI,EAAE,EAAE;oBACV,QAAQ,GAAG,CAAC,+BAA+B,KAAK,OAAO;oBAEvD,6CAA6C;oBAC7C,MAAM,aAAa;wBAAC;wBAAgB;qBAAkB;oBACtD,IAAI,WAAW,QAAQ,CAAC,WAAW;wBACjC,OAAO,OAAO,CAAC;oBACjB;gBACF;YACA,4EAA4E;YAC9E,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,8BAA8B;YAC9C;QACF;QAEA;IACF,GAAG;QAAC;QAAQ;KAAS;IAErB,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///D:/Seguridad%20Informatica/ScorpionWeb/frontend2/src/app/pages/crea-noticia/page.js"],"sourcesContent":["'use client';\r\nimport ProtectedPage from '@/components/ProtectedPage';\r\nimport { useState } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport Link from 'next/link';\r\nexport default function AddNoticiaPage() {\r\n  const [title, setTitle] = useState('');\r\n  const [description, setDescription] = useState('');\r\n  const [image, setImage] = useState(null);\r\n  const [preview, setPreview] = useState(null);\r\n  const [mensaje, setMensaje] = useState('');\r\n  const router = useRouter();\r\n\r\n  // Convierte la imagen a base64\r\n  const handleImageChange = (e) => {\r\n    const file = e.target.files[0];\r\n    if (!file) return;\r\n\r\n    const reader = new FileReader();\r\n    reader.onloadend = () => {\r\n      setImage(reader.result);\r\n      setPreview(reader.result);\r\n    };\r\n    reader.readAsDataURL(file);\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setMensaje('');\r\n\r\n    try {\r\n      const res = await fetch('http://localhost:3001/api/noticias/add-noticia', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ title, descripcion: description, imageBase64: image }),\r\n        credentials: 'include',\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (data.success) {\r\n        setMensaje('Noticia creada correctamente!');\r\n        setTitle('');\r\n        setDescription('');\r\n        setImage(null);\r\n        setPreview(null);\r\n      } else {\r\n        setMensaje(`${data.mensaje || 'Error al crear la noticia'}`);\r\n      }\r\n    } catch (error) {\r\n      console.error(error);\r\n      setMensaje('Error al conectar con el servidor');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <ProtectedPage>\r\n      <div className=\"min-h-screen flex items-center justify-center bg-black p-6\">\r\n        <div className=\"w-full max-w-xl bg-gradient-to-tr from-gray-800 via-gray-900 to-black rounded-3xl shadow-2xl p-10 space-y-6 border border-gray-700\">\r\n          <h1 className=\"text-4xl font-extrabold text-center text-indigo-400 mb-4\">\r\n            游닗 Agregar Noticia\r\n          </h1>\r\n\r\n          <form onSubmit={handleSubmit} className=\"space-y-5\">\r\n            <div>\r\n              <label className=\"block mb-2 font-semibold text-gray-300\">T칤tulo:</label>\r\n              <input\r\n                type=\"text\"\r\n                value={title}\r\n                onChange={(e) => setTitle(e.target.value)}\r\n                required\r\n                placeholder=\"Escribe el t칤tulo de la noticia\"\r\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block mb-2 font-semibold text-gray-300\">Descripci칩n:</label>\r\n              <textarea\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                placeholder=\"Agrega una descripci칩n breve de la noticia\"\r\n                rows={4}\r\n                className=\"w-full px-4 py-3 rounded-xl bg-gray-700 text-gray-100 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition resize-none\"\r\n              />\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block mb-2 font-semibold text-gray-300\">Imagen (opcional):</label>\r\n              <input\r\n                type=\"file\"\r\n                accept=\"image/*\"\r\n                onChange={handleImageChange}\r\n                className=\"text-gray-200\"\r\n              />\r\n            </div>\r\n\r\n            {preview && (\r\n              <div className=\"mt-4\">\r\n                <p className=\"mb-2 font-semibold text-indigo-300\">Vista previa:</p>\r\n                <img\r\n                  src={preview}\r\n                  alt=\"preview\"\r\n                  className=\"rounded-xl max-h-64 w-full object-contain border border-gray-600 shadow-inner\"\r\n                />\r\n              </div>\r\n            )}\r\n\r\n            <button\r\n              type=\"submit\"\r\n              className=\"w-full py-3 bg-indigo-600 hover:bg-indigo-700 transition-colors text-white font-bold rounded-xl shadow-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none\"\r\n            >\r\n              Crear Noticia\r\n            </button>\r\n          </form>\r\n          <Link href=\"/pages/home\" >\r\n                <button\r\n                type=\"submit\"\r\n                className=\"w-full py-3 bg-indigo-600 hover:bg-indigo-700 transition-colors text-white font-bold rounded-xl shadow-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none\"\r\n                >\r\n                    Home\r\n                </button>\r\n            </Link>\r\n\r\n          {mensaje && (\r\n            <p className=\"text-center mt-4 font-medium text-yellow-400\">\r\n              {mensaje}\r\n            </p>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </ProtectedPage>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AACA;AACA;AAJA;;;;;;AAKe,SAAS;IACtB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IACnC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,+BAA+B;IAC/B,MAAM,oBAAoB,CAAC;QACzB,MAAM,OAAO,EAAE,MAAM,CAAC,KAAK,CAAC,EAAE;QAC9B,IAAI,CAAC,MAAM;QAEX,MAAM,SAAS,IAAI;QACnB,OAAO,SAAS,GAAG;YACjB,SAAS,OAAO,MAAM;YACtB,WAAW,OAAO,MAAM;QAC1B;QACA,OAAO,aAAa,CAAC;IACvB;IAEA,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,WAAW;QAEX,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,kDAAkD;gBACxE,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAO,aAAa;oBAAa,aAAa;gBAAM;gBAC3E,aAAa;YACf;YAEA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,KAAK,OAAO,EAAE;gBAChB,WAAW;gBACX,SAAS;gBACT,eAAe;gBACf,SAAS;gBACT,WAAW;YACb,OAAO;gBACL,WAAW,GAAG,KAAK,OAAO,IAAI,6BAA6B;YAC7D;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC;YACd,WAAW;QACb;IACF;IAEA,qBACE,8OAAC,8IAAa;kBACZ,cAAA,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAG,WAAU;kCAA2D;;;;;;kCAIzE,8OAAC;wBAAK,UAAU;wBAAc,WAAU;;0CACtC,8OAAC;;kDACC,8OAAC;wCAAM,WAAU;kDAAyC;;;;;;kDAC1D,8OAAC;wCACC,MAAK;wCACL,OAAO;wCACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wCACxC,QAAQ;wCACR,aAAY;wCACZ,WAAU;;;;;;;;;;;;0CAId,8OAAC;;kDACC,8OAAC;wCAAM,WAAU;kDAAyC;;;;;;kDAC1D,8OAAC;wCACC,OAAO;wCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;wCAC9C,aAAY;wCACZ,MAAM;wCACN,WAAU;;;;;;;;;;;;0CAId,8OAAC;;kDACC,8OAAC;wCAAM,WAAU;kDAAyC;;;;;;kDAC1D,8OAAC;wCACC,MAAK;wCACL,QAAO;wCACP,UAAU;wCACV,WAAU;;;;;;;;;;;;4BAIb,yBACC,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAE,WAAU;kDAAqC;;;;;;kDAClD,8OAAC;wCACC,KAAK;wCACL,KAAI;wCACJ,WAAU;;;;;;;;;;;;0CAKhB,8OAAC;gCACC,MAAK;gCACL,WAAU;0CACX;;;;;;;;;;;;kCAIH,8OAAC,uKAAI;wBAAC,MAAK;kCACL,cAAA,8OAAC;4BACD,MAAK;4BACL,WAAU;sCACT;;;;;;;;;;;oBAKN,yBACC,8OAAC;wBAAE,WAAU;kCACV;;;;;;;;;;;;;;;;;;;;;;AAOf","debugId":null}}]
}